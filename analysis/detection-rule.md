# Detection Rule â€“ SSH Brute Force Attack

## ğŸ“Œ Rule Name

**SSH Brute Force Detection â€“ Excessive Authentication Attempts**

---

## ğŸ§  Description

This detection rule identifies potential **SSH brute force attacks** by monitoring excessive SSH connection attempts from a single source IP within a short time window.

The rule leverages **endpoint telemetry** generated by Sysmon and OpenSSH logs to detect abnormal authentication behavior indicative of credential guessing attacks.

---

## ğŸ¯ MITRE ATT&CK Mapping

| Tactic            | Technique               |
| ----------------- | ----------------------- |
| Credential Access | T1110 â€“ Brute Force     |
| Lateral Movement  | T1021 â€“ Remote Services |

---

## ğŸ“¡ Data Source

| Component  | Details                |
| ---------- | ---------------------- |
| Log Source | Windows Sysmon         |
| Event ID   | 3 â€“ Network Connection |
| Process    | `sshd.exe`             |
| SIEM       | Splunk Enterprise      |
| Index      | `endpoint`             |

---

## ğŸ” Detection Logic

### Detection Condition

Trigger an alert when:

* More than **5 SSH connection attempts**
* From the **same source IP**
* To **destination port 22**
* Within a defined time window

---

## ğŸ§ª SPL Query

```spl
index=endpoint EventID=3 Image="*sshd.exe*" DestinationPort=22
| stats count by SourceIp
| where count > 5
```

---

## ğŸš¨ Alert Threshold

| Parameter   | Value                               |
| ----------- | ----------------------------------- |
| Attempts    | > 5                                 |
| Time Window | Analyst-defined (e.g. 5â€“10 minutes) |
| Scope       | Per Source IP                       |

---

## ğŸ§  Alert Context Provided

When triggered, the alert should include:

* Source IP address
* Number of SSH attempts
* Target host
* Timestamp range

This context allows analysts to quickly assess whether the activity is malicious or benign.

---

## âš ï¸ False Positive Considerations

Possible benign scenarios:

* User mistyping credentials repeatedly
* Automated scripts with incorrect credentials
* Monitoring or health-check tools

Recommended mitigations:

* Correlate with authentication success events
* Exclude trusted IP ranges if necessary
* Apply time-based thresholds

---

## ğŸ›‘ Recommended Response Actions

1. Validate source IP behavior in Splunk
2. Check for successful authentication events
3. Temporarily block attacker IP via firewall
4. Reset compromised user credentials
5. Document incident findings

---

## ğŸ§ª Lab Validation

This rule was validated by:

* Simulating an SSH brute force attack from Kali Linux
* Observing increased SSH connection telemetry
* Successfully detecting abnormal activity in Splunk
* Blocking attacker IP as an incident response action

---

## ğŸ“˜ Analyst Notes

This detection demonstrates how **network-based endpoint telemetry** can be used to detect brute force behavior without inspecting credentials directly.

The rule is effective for:

* Entry-level SOC monitoring
* Threat hunting exercises
* Detection engineering practice


Balas saja:
**â€œLANJUT REPO 3â€** atau **â€œUPGRADE RULEâ€**
